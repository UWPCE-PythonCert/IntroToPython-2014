
data = [
  {
    "_id": "5475588cd773eee8d82e2463",
    "index": 0,
    "guid": "d7257e39-ec09-45a0-86b6-e88630699c09",
    "isActive": True,
    "balance": "$1,670.60",
    "picture": "http://placehold.it/32x32",
    "age": 35,
    "eyeColor": "blue",
    "name": "Lamb Rich",
    "gender": "male",
    "company": "SNORUS",
    "email": "lambrich@snorus.com",
    "phone": "+1 (817) 598-3255",
    "address": "414 Friel Place, Oasis, Virginia, 7636",
    "about": "Cillum cupidatat dolor et commodo ullamco ut anim ipsum Lorem irure. Duis dolor tempor fugiat incididunt amet deserunt qui ad exercitation in. Pariatur excepteur non aute nisi Lorem enim ullamco. Sunt sint sint exercitation et voluptate ea. Consectetur reprehenderit consectetur duis minim enim culpa laborum. Eu occaecat laboris nulla do ad adipisicing commodo. Sint laboris excepteur duis do aliqua in aliqua mollit.\r\n",
    "registered": "2014-02-24T01:40:22 +08:00",
    "latitude": 2.855763,
    "longitude": -92.222649,
    "tags": [
      "fugiat",
      "exercitation",
      "ut",
      "nulla",
      "elit",
      "Lorem",
      "ipsum"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Viola Atkinson"
      },
      {
        "id": 1,
        "name": "Jan Wilkins"
      },
      {
        "id": 2,
        "name": "Tabatha Joyce"
      }
    ],
    "greeting": "Hello, Lamb Rich! You have 10 unread messages.",
    "favoriteFruit": "apple"
  },
  {
    "_id": "5475588c56be2580c9408311",
    "index": 1,
    "guid": "16ba5068-fded-4def-9f34-f6c0b9e68cdf",
    "isActive": False,
    "balance": "$1,004.81",
    "picture": "http://placehold.it/32x32",
    "age": 28,
    "eyeColor": "brown",
    "name": "Francine Wheeler",
    "gender": "female",
    "company": "EZENT",
    "email": "francinewheeler@ezent.com",
    "phone": "+1 (863) 594-2810",
    "address": "684 Perry Place, Savannah, Florida, 1063",
    "about": "Amet voluptate exercitation occaecat eu in proident. Consectetur ad sit non duis nulla non velit ut aliquip occaecat amet ad proident dolore. Consectetur aliquip sunt esse nisi Lorem consectetur. Culpa reprehenderit consectetur deserunt ex aute quis magna ex proident officia sit. Esse nisi et aute dolore ut aliqua culpa exercitation duis officia adipisicing.\r\n",
    "registered": "2014-11-06T20:04:25 +08:00",
    "latitude": 87.321587,
    "longitude": -132.980453,
    "tags": [
      "nulla",
      "duis",
      "nulla",
      "laboris",
      "dolor",
      "Lorem",
      "ullamco"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Kirsten Pittman"
      },
      {
        "id": 1,
        "name": "Harper Jefferson"
      },
      {
        "id": 2,
        "name": "Wolfe Howard"
      }
    ],
    "greeting": "Hello, Francine Wheeler! You have 10 unread messages.",
    "favoriteFruit": "apple"
  },
  {
    "_id": "5475588c6d41bbbbf5e13d70",
    "index": 2,
    "guid": "e86edee1-3a58-4a0f-8112-bc64e27c894b",
    "isActive": False,
    "balance": "$3,318.98",
    "picture": "http://placehold.it/32x32",
    "age": 35,
    "eyeColor": "blue",
    "name": "Maureen Ryan",
    "gender": "female",
    "company": "PHARMEX",
    "email": "maureenryan@pharmex.com",
    "phone": "+1 (838) 587-2028",
    "address": "877 Alabama Avenue, Wilmington, Oklahoma, 6576",
    "about": "Est dolore Lorem proident irure aute. Ex do nostrud voluptate nisi ad occaecat magna consequat Lorem. Adipisicing commodo officia commodo fugiat fugiat ex Lorem enim fugiat proident exercitation laborum. Officia sit laborum laboris Lorem incididunt tempor laborum anim et laborum. Veniam qui commodo fugiat non nisi irure labore ut dolore officia.\r\n",
    "registered": "2014-03-15T02:35:03 +07:00",
    "latitude": 69.771061,
    "longitude": -91.642448,
    "tags": [
      "commodo",
      "aliqua",
      "laborum",
      "esse",
      "fugiat",
      "labore",
      "excepteur"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Russo Larsen"
      },
      {
        "id": 1,
        "name": "Hopkins Yates"
      },
      {
        "id": 2,
        "name": "Marcy Meyers"
      }
    ],
    "greeting": "Hello, Maureen Ryan! You have 1 unread messages.",
    "favoriteFruit": "apple"
  },
  {
    "_id": "5475588c2866a41137649226",
    "index": 3,
    "guid": "7d1d8e3f-a82e-42c3-9f34-113f2d8e65d3",
    "isActive": True,
    "balance": "$2,273.16",
    "picture": "http://placehold.it/32x32",
    "age": 38,
    "eyeColor": "green",
    "name": "Austin Wilkerson",
    "gender": "male",
    "company": "PRISMATIC",
    "email": "austinwilkerson@prismatic.com",
    "phone": "+1 (878) 508-3858",
    "address": "700 Columbus Place, Roeville, American Samoa, 5099",
    "about": "Dolor quis minim dolore exercitation proident ex occaecat esse pariatur dolore officia sit. Sunt dolore eu ex irure. Dolore in occaecat commodo ut est do ea sunt laborum et.\r\n",
    "registered": "2014-04-17T22:35:57 +07:00",
    "latitude": 70.648972,
    "longitude": -0.802905,
    "tags": [
      "officia",
      "ea",
      "amet",
      "amet",
      "deserunt",
      "fugiat",
      "cupidatat"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Curry Reilly"
      },
      {
        "id": 1,
        "name": "Fletcher Morris"
      },
      {
        "id": 2,
        "name": "Loretta Bartlett"
      }
    ],
    "greeting": "Hello, Austin Wilkerson! You have 4 unread messages.",
    "favoriteFruit": "apple"
  },
  {
    "_id": "5475588cdcaef598a942c34b",
    "index": 4,
    "guid": "1a0cf232-4421-48ff-8cf4-0341d5b5aebc",
    "isActive": False,
    "balance": "$3,094.71",
    "picture": "http://placehold.it/32x32",
    "age": 36,
    "eyeColor": "green",
    "name": "Hayden Heath",
    "gender": "male",
    "company": "OLYMPIX",
    "email": "haydenheath@olympix.com",
    "phone": "+1 (876) 515-2202",
    "address": "786 Maple Street, Eastmont, Oregon, 1622",
    "about": "Laboris incididunt reprehenderit ipsum exercitation et proident laborum Lorem in veniam exercitation adipisicing proident. Quis eiusmod anim culpa aliquip excepteur sunt ea cupidatat deserunt culpa reprehenderit veniam eiusmod. In nulla duis aute adipisicing reprehenderit tempor voluptate labore ut sit. Ex et nisi nostrud ex amet culpa id sunt et ad eiusmod. Tempor reprehenderit esse adipisicing consectetur est qui fugiat proident velit magna eiusmod. Do sint tempor nulla qui anim nisi pariatur ullamco nulla. Adipisicing tempor anim aliqua ut officia dolore officia ex excepteur voluptate nostrud nulla deserunt do.\r\n",
    "registered": "2014-06-24T01:21:18 +07:00",
    "latitude": -68.99539,
    "longitude": -67.122518,
    "tags": [
      "ea",
      "elit",
      "adipisicing",
      "amet",
      "consequat",
      "occaecat",
      "cupidatat"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Barr Wood"
      },
      {
        "id": 1,
        "name": "Phoebe Goodwin"
      },
      {
        "id": 2,
        "name": "Elisabeth Richards"
      }
    ],
    "greeting": "Hello, Hayden Heath! You have 5 unread messages.",
    "favoriteFruit": "strawberry"
  },
  {
    "_id": "5475588c1c18f737641e1c4b",
    "index": 5,
    "guid": "bebe4231-8083-44bf-a93f-6177d21f88a3",
    "isActive": True,
    "balance": "$3,704.84",
    "picture": "http://placehold.it/32x32",
    "age": 21,
    "eyeColor": "green",
    "name": "Denise Riddle",
    "gender": "female",
    "company": "EURON",
    "email": "deniseriddle@euron.com",
    "phone": "+1 (827) 591-3276",
    "address": "901 Bliss Terrace, Austinburg, Louisiana, 685",
    "about": "Elit anim dolore esse laboris consectetur ipsum deserunt nostrud ullamco in ex. Quis enim ut pariatur et non eiusmod irure irure ex veniam Lorem officia do Lorem. Enim reprehenderit laboris mollit sint officia nisi aute cillum in labore dolore. Fugiat cillum quis eu esse eu esse veniam ea qui id culpa. Labore officia qui sint magna et Lorem cillum adipisicing culpa. Nostrud dolor commodo eiusmod laborum ipsum non adipisicing aliqua consectetur. Commodo incididunt ea dolor incididunt.\r\n",
    "registered": "2014-09-05T11:52:25 +07:00",
    "latitude": 52.007545,
    "longitude": -93.800535,
    "tags": [
      "incididunt",
      "minim",
      "labore",
      "deserunt",
      "pariatur",
      "sunt",
      "sunt"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Aisha Hardin"
      },
      {
        "id": 1,
        "name": "Keri Woodard"
      },
      {
        "id": 2,
        "name": "Tricia Newton"
      }
    ],
    "greeting": "Hello, Denise Riddle! You have 10 unread messages.",
    "favoriteFruit": "banana"
  },
  {
    "_id": "5475588c84fb2c5fe7baefc8",
    "index": 6,
    "guid": "0272db64-5c56-455b-ba66-40ece87fd4c7",
    "isActive": True,
    "balance": "$3,053.47",
    "picture": "http://placehold.it/32x32",
    "age": 33,
    "eyeColor": "green",
    "name": "Corrine Lynn",
    "gender": "female",
    "company": "XYLAR",
    "email": "corrinelynn@xylar.com",
    "phone": "+1 (984) 593-3360",
    "address": "355 Woodhull Street, Crayne, Puerto Rico, 9014",
    "about": "Excepteur in incididunt sunt nostrud nostrud velit. Nostrud in enim culpa labore. Sint aute minim do consectetur irure Lorem voluptate pariatur exercitation.\r\n",
    "registered": "2014-09-22T04:09:22 +07:00",
    "latitude": 14.366599,
    "longitude": 170.168244,
    "tags": [
      "amet",
      "occaecat",
      "pariatur",
      "adipisicing",
      "do",
      "Lorem",
      "do"
    ],
    "friends": [
      {
        "id": 0,
        "name": "Bennett Chang"
      },
      {
        "id": 1,
        "name": "Dickson Rogers"
      },
      {
        "id": 2,
        "name": "Shepherd Colon"
      }
    ],
    "greeting": "Hello, Corrine Lynn! You have 1 unread messages.",
    "favoriteFruit": "banana"
  }
]

# def json_to_sql (data,level=0):
# 	next_level = level+1

# 	if isinstance(data, dict):
# 		print "\t"*level,"type: %s, len: %s, level: %s" % (type(data),len(data), level)
# 		keys = data.keys()
# 		keys_len = len(keys)
		
# 		for n,k in enumerate(keys):
# 			kind = json_to_sql(data[k],next_level)
# 			if kind:
# 				print "\t"*next_level,"key: %s" % k,json_to_sql(data[k],next_level)
			


# 	elif isinstance(data, list):
# 		print "\t"*level,"type: %s, len: %s, level: %s" % (type(data),len(data), level)
# 		for k,d in enumerate(data):
# 			kind = json_to_sql(d,next_level)
# 			if kind:
# 				print "\t"*next_level,"key: %s" % k,json_to_sql(d,next_level)

	
# 	else:
# 		return type(data)

# 	return None
























def json_to_sql (data,level=0,key=None):

	def iterate_through(elements,k=key):
		# log = open("sql.log", "a")
		print "CREATE TABLE IF NOT EXISTS %s (%s)" % (k,elements)
		next_level = level+1
		print "\t"*level,"key: %s, type: %s, len: %s, level: %s" % (key,type(data),len(data), level)

		for e in elements:
			kind = json_to_sql(data[e],next_level)
			if kind:
				print "\t"*next_level,"key: %s" % e,json_to_sql(data[e],next_level,e)


	if isinstance(data, dict):
		keys = data.keys()
		iterate_through(keys,key)		

	elif isinstance(data, list):
		indices = [index for index,value in enumerate(data)]
		iterate_through(indices)

	else:
		return type(data)

	return None


json_to_sql(data)






# class Query:
# 	query = ''
# 	# always end with ';' somehow


# 	def create_table(self, name, **columns):
# 		fields = ''
# 		for k in columns.keys():
# 			fields += "%s %s, " % (k,columns[k])

# 		self.query += "CREATE TABLE %s ( %s ) " % (name,fields) 
# 		return self   


# 	def select(self, *columns):
# 		columns = "%s" % (columns,)
# 		columns = columns.strip("()").replace("'","")

# 		self.query += "SELECT %s " % columns 
# 		return self   

# 	def from_table(self, *tables):
# 		tables = "%s" % (tables,)
# 		tables = tables.strip("()").replace("'","")
		
# 		self.query += "FROM %s " % tables 
		
# 		return self


# 	def where(self, conds):
# 		conds = "%s" % (conds,)
# 		conds = conds.strip("()").replace("'","")
		
# 		self.query += "WHERE %s " % conds 
		
# 		return self


# 	def limit(self, num):
# 		self.query += "LIMIT %d" % num

# 		return self



# 	def group_by(self, num):
# 		# self.query += "LIMIT %d" % num

# 		return self

# 	def update(self, num):
# 		# self.query += "LIMIT %d" % num

# 		return self

# 	def insert_into(self, num):
# 		# self.query += "LIMIT %d" % num

# 		return self

# 	def delete_from(self, num):
# 		# self.query += "LIMIT %d" % num

# 		return self




# 	def run(self): pass # requires db connection
# 	def test(self): pass
# 	def clear(self):
# 		self.query = '' 
# 		return self 



# if __name__ == '__main__':
	
# 	q = Query()
# 	under_thirty = q.select("first_name","last_name","age") \
# 					.frm("persons") \
# 					.where("age < 30") \
# 					.limit(10)

# 	print under_thirty.query



# 	example = open('example.sql','w')







# """
# I think I need to build a "blueprint" dictionary for tables and fields,
# then convert to SQL "create table" and "insert into" statements.

# : project scope
# 	input = JSON
# 	output = SQL
# 	platform = sqlite3

# - create "blueprint" dictionary object

# - open and or pass JSON to framework



# - iterate over each line
# 	- identify type and create field
# 	- if list or dict
# 		- create new "logging" table 
# 		- iterate over each field


# """



if __name__ == '__main__':
	# json_to_sql(data)
	print "query: %s" % json_to_sql(data)

